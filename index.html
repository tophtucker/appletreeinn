<!DOCTYPE html>
<html>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <link rel="icon" href="favicon.png" />
  <link rel="stylesheet" href="styles.css" />
  <title>Apple Tree Inn • Lenox, MA</title>

  <header>
    <img src="logo.svg" height="200" />
    <div class="links">
      <a href="https://maps.app.goo.gl/vpsxJ5KnzqR1n78q8" target="_blank"
        >Lenox, MA</a
      >
      <a href="https://www.instagram.com/appletreeinn" target="_blank"
        >Instagram</a
      >
      <a href="mailto:info@appletreeinnlenox.com" target="_blank">Email</a>
    <a href="tel:1.413.200.8456" target="_blank">(413) 200-8456</a>
    <div>
      <a
        href="https://appletreeinn.book.pegsbe.com/"
        target="_blank"
        class="highlight"
        >Reserve</a
      >
    </div>
  </header>

  <div class="intro">
    <article>
      <p style="font-size: 2em">
        The Apple Tree Inn is a small historic hotel in the Berkshires.
      </p>
      <p>
        It is the only hotel within walking distance to
        <a href="https://www.bso.org/tanglewood/" target="_blank">Tanglewood</a>
        and <a href="https://kripalu.org/">Kripalu</a>.
      </p>
      <p>
        The guest rooms are currently open Thursday, Friday and Saturday nights
        and will be open 7 days a week starting June 1. We’re working as hard as
        we can to reopen the Ostrich Room (our tavern) in early June. We are
        planning for Wed, Thu, Fri, Sat nights from 4–10pm with live music a
        couple times a week. The idea is great, simple drinks and great, simple
        food. We’ll post more here as we figure it out.
      </p>
      <p>
        We are hiring a cook; please 
        <a href="mailto:claire@appletreeinnlenox.com"
          >email Claire</a
        >
        if you know someone great!
      </p>
    </article>
  </div>

  <nav>
    <form id="reserve">
      From <input id="start" type="date" /> to <input id="end" type="date" />
      <button type="submit">Reserve</button>
    </form>
  </nav>

  <div class="rooms-section">
    <div class="tabs-wrapper">
      <div class="tabs">
        <em>Choose your building</em>
        <h2 class="tab" data-tab="main-house">Main House</h2>
        <h2 class="tab" data-tab="summer-annex">Summer Annex</h2>
      </div>
    </div>
    <div id="buildingContainer"></div>
  </div>

  <script type="module">
    import * as d3 from "https://esm.run/d3@7.1";
    import * as htl from "https://esm.run/htl";

    const mainHouse = [
      {
        number: "Room 1",
        name: "Orchard",
        desc: `Located on the second floor of our 1885 main house, the centerpieces of this room are a charming working fireplace and a spacious balcony with seating for reading, sipping coffee, and watching the sunset. A romantic wrought iron bed features high-thread-count Frette linens, while an indoor seating area includes an expandable full bed for additional guests. Enjoy views of the woods and sink into a deep reading chair for full relaxation, or tackle a creative project at the included desk. A full bath is outfitted with our luxe Beekman 1802 bath amenities.`,
      },
      {
        number: "Room 2",
        name: "Astalula",
        desc: `One of our most luxe rooms, Astalula includes charming details original to the 1885 Victorian mansion, including an intimate daybed tucked into a French window alcove, surrounded by lush trees and a built-in wood-burning fireplace. Spread out in the plush king bed featuring Frette linens, nap in the chaise lounge, and soak in the full bath using our signature Beekman 1802 amenities.`,
      },
      {
        number: "Room 3",
        name: "Bristed Suite",
        desc: `Make a grand entrance to this massive suite on the second floor of our Victorian mansion. This spacious king suite offers a taste of historic elegance with modern amenities like Frette linens and Beekman 1802 bath products. A brass king bed, fully separate living room with a pull-out couch, writing desk, and wood-burning fireplace will make you never want to leave this creative haven. An included table seats four for shared dinner, and wide windows open to expansive views of the rolling hills.`,
      },
    ];

    const summerAnnex = [
      {
        name: "Queen",
        desc: `Ideal for a solo getaway or a romantic couples weekend, this room includes a plush queen bed dressed in Frette linens and space to spread out. Read a book by the window with views of the forest, or sit down to work at the full size writing desk. In the bathroom you’ll find a shower with an included tub, outfitted with 1802 bath amenities.`,
      },
      {
        name: "Two Double",
        desc: `Richly textured and warmly designed, this Lodge room features two double beds and is a great choice for a weekend trip to reconnect with a friend, or a convenient setting for a family getaway. A spacious bathroom offers a full bath, and amenities include our signature Beekman 1802 bath products and silky Frette sateen sheets.`,
      },
      {
        name: "Queen, Mountain View",
        desc: `A favorite for couples getaways or some indulgent solo time, this Lodge queen features expansive windows with views of the rustling trees and a soaring mountain backdrop. Sink into our soft Frette linens and soak in the full bath using our signature Beekman 1802 amenities.`,
      },
      {
        name: "Two Double, Mountain View",
        desc: `Located on both the first and second floors of our Lodge, these rooms offer large windows and sprawling views of our rolling lawns and the treetops beyond. In addition to the stunning sights, each room includes two double beds outfitted in our high-thread-count Frette linens and a full bath including Beekman 1802 amenities. A great choice for friends and families alike.`,
      },
    ];

    const buildings = [
      {
        id: "main-house",
        title: "Main House",
        rooms: mainHouse,
        img: "heropics/main-house.jpg",
        desc: `Built in 1885, sited overlooking the hill, three stories, has tavern, every room is unique.`,
      },
      {
        id: "summer-annex",
        title: "Summer Annex",
        rooms: summerAnnex,
        img: "heropics/summer-annex.jpg",
        desc: `Open from Memorial Day to Labor Day, has four standard room types, over by the pool.`,
      },
    ];

    const isoDate = "%Y-%m-%d";
    const dateParse = d3.timeParse(isoDate);
    const dateFormat = d3.timeFormat(isoDate);
    const today = d3.timeDay(new Date());
    start.setAttribute("min", dateFormat(today));
    end.setAttribute("min", dateFormat(today));
    start.value = dateFormat(today);
    end.value = dateFormat(d3.timeDay.offset(today, 1));

    reserve.addEventListener("submit", (e) => {
      e.preventDefault();
      const dates = [start, end]
        .map((d) => d3.isoParse(d.value))
        .sort((a, b) => d3.ascending(a, b));
      const los = d3.timeDay.count(...dates);
      window.location.href = `https://appletreeinn.book.pegsbe.com/search?CheckinDate=${start.value}&LOS=${los}&nights=&Rooms=1`;
    });

    const tabs = document.querySelectorAll(".tabs h2");
    for (const tab of tabs) {
      tab.addEventListener("click", (e) => {
        renderRooms(e.currentTarget.dataset.tab);
      });
    }

    renderRooms("main-house");

    function renderRooms(tab) {
      buildingContainer.innerHTML = "";
      d3.selectAll(".tabs h2").classed("active", false);
      d3.select(`[data-tab=${tab}]`).classed("active", true);
      const { title, desc, img, rooms } = buildings.find((d) => d.id === tab);
      buildingContainer.appendChild(htl.html`<div>
        <div class="building">
          <img src=${img} width=400 />
          <div>${desc}</div>
        </div>
        ${rooms.map(
          ({ number, name, desc }, i) => htl.html`<div class="room">
            <div>
              ${
                number !== undefined ? htl.html`<small>${number}</small>` : null
              }
              <h3>${name}</h3>
              <p>${desc}</p>
            </div>
            <img src="roompics/${tab}/${i + 1}-1.jpg" width="500">
          </div>`
        )}
        </div>`);
    }
  </script>
</html>
